<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>SnelDB Dashboard</title>
  <link rel="stylesheet" href="/static/styles.css" />
  <link rel="stylesheet" href="/static/highlight.css" />
  <link rel="icon" href="data:," />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
  <script type="module">
    // Load Apache Arrow as ES module and expose it globally
    try {
      import('https://cdn.jsdelivr.net/npm/apache-arrow@15.0.0/+esm').then(Arrow => {
        window.ApacheArrow = Arrow;
        // Dispatch event to notify that Arrow is ready
        window.dispatchEvent(new CustomEvent('arrow-loaded'));
      }).catch(err => {
        console.error('Failed to load Apache Arrow:', err);
        window.ApacheArrow = null;
      });
    } catch (err) {
      console.error('Error importing Apache Arrow:', err);
    }
  </script>
</head>
<body>
  <div id="app">
    <header>
      <div class="header-content">
        <div class="logo-section">
          <h1>SnelDB Dashboard</h1>
          <p class="tagline">Query. Visualize. Analyze.</p>
        </div>
        <nav class="nav-tabs">
          <button class="nav-tab active" data-page="query">
            <i class="fas fa-database"></i>
            Query
          </button>
          <button class="nav-tab" data-page="monitoring">
            <i class="fas fa-chart-line"></i>
            Monitoring
          </button>
        </nav>
        <div class="header-actions">
          <button id="settingsBtn" class="btn btn-secondary btn-sm" style="display: none;">
            <i class="fas fa-cog"></i>
            Settings
          </button>
          <button id="themeToggle" class="theme-toggle" aria-label="Toggle theme">
            <i class="far fa-sun sun-icon"></i>
            <i class="far fa-moon moon-icon"></i>
          </button>
          <div class="status" id="status">
            <span class="status-indicator"></span>
            <span class="status-text">Ready</span>
          </div>
        </div>
      </div>
    </header>
    <main>
      <!-- Query Page -->
      <div id="queryPage" class="page-content active">
      <section class="input-section">
        <div class="section-header">
          <h2>Query Editor</h2>
        </div>
        <div class="editor">
          <pre aria-hidden="true"><code id="hl" class="language-sneldb"></code></pre>
          <textarea id="command" placeholder="Enter your SnelDB query here...">QUERY stress_evt WHERE id < 1000 COUNT PER week USING created_at BY plan LIMIT 10</textarea>
        </div>
        <div class="actions">
          <button id="run" class="btn btn-primary">
            <i class="fas fa-play"></i>
            Run Query
          </button>
          <button id="clear" class="btn btn-secondary">Clear</button>
        </div>
      </section>
      <section class="output-section">
        <div class="section-header">
          <h2>Results</h2>
          <div class="pagination-controls" id="paginationControls" style="display: none;">
            <div class="pagination-info" id="paginationInfo"></div>
            <div class="pagination-buttons">
              <button id="paginationPrev" class="btn btn-secondary btn-sm">Previous</button>
              <button id="paginationNext" class="btn btn-secondary btn-sm">Next</button>
              <label class="pagination-label">
                Page size:
                <select id="paginationPageSize" class="pagination-select">
                  <option value="50">50</option>
                  <option value="100" selected>100</option>
                  <option value="250">250</option>
                  <option value="500">500</option>
                  <option value="1000">1000</option>
                  <option value="5000">5000</option>
                </select>
              </label>
            </div>
          </div>
          <div class="view-controls" id="viewControls" style="display: none;">
            <button class="view-btn active" data-view="chart" id="chartViewBtn">
              <i class="far fa-chart-bar"></i>
              Chart
            </button>
            <button class="view-btn" data-view="table" id="tableViewBtn">
              <i class="fas fa-table"></i>
              Table
            </button>
            <button class="view-btn" data-view="json" id="jsonViewBtn">
              <i class="fas fa-code"></i>
              JSON
            </button>
          </div>
        </div>
        <div class="output-container">
          <div id="chartView" class="view-content active">
            <div class="chart-controls" id="chartControls" style="display: none;">
              <div class="control-group">
                <label class="chart-type-label">Chart Type:</label>
                <div class="chart-type-buttons">
                  <button class="chart-type-btn active" data-type="bar">Bar</button>
                  <button class="chart-type-btn" data-type="line">Line</button>
                  <button class="chart-type-btn" data-type="pie">Pie</button>
                  <button class="chart-type-btn" data-type="doughnut">Doughnut</button>
                </div>
              </div>
              <div class="control-group">
                <label class="chart-type-label" for="colorSchemeSelect">Colors:</label>
                <select id="colorSchemeSelect" class="color-scheme-select">
                  <option value="multicolor">Multicolor</option>
                  <option value="blues">Blues</option>
                  <option value="greens">Greens</option>
                  <option value="purples">Purples</option>
                  <option value="warm">Warm</option>
                  <option value="earth">Earth</option>
                  <option value="ocean">Ocean</option>
                  <option value="sunset">Sunset</option>
                  <option value="forest">Forest</option>
                  <option value="monochrome">Monochrome</option>
                  <option value="pastel">Pastel</option>
                  <option value="vibrant">Vibrant</option>
                </select>
              </div>
            </div>
            <div class="chart-wrapper">
              <canvas id="chart"></canvas>
            </div>
            <div class="empty-state" id="emptyState">
              <i class="far fa-chart-bar" style="font-size: 48px; opacity: 0.3;"></i>
              <p>Run a query to visualize results</p>
            </div>
          </div>
          <div id="tableView" class="view-content">
            <div class="table-wrapper">
              <table id="dataTable"></table>
            </div>
          </div>
          <div id="jsonView" class="view-content">
            <pre><code id="output" class="language-json"></code></pre>
          </div>
        </div>
      </section>
      </div>
      <!-- Monitoring Page -->
      <div id="monitoringPage" class="page-content">
        <section class="monitoring-section">
          <div class="monitoring-grid" id="monitoringGrid">
            <!-- 6 monitoring slots will be generated here -->
          </div>
        </section>
      </div>
      <!-- Settings Modal -->
      <div id="settingsModal" class="modal">
        <div class="modal-content">
          <div class="modal-header">
            <h2>Monitoring Settings</h2>
            <button class="modal-close" id="closeSettingsModal">
              <i class="fas fa-times"></i>
            </button>
          </div>
          <div class="modal-body">
            <div class="setting-group">
              <label class="refresh-label">
                <input type="checkbox" id="autoRefresh" />
                <span>Auto-refresh</span>
              </label>
              <select id="refreshInterval" class="refresh-select">
                <option value="5">5 seconds</option>
                <option value="10" selected>10 seconds</option>
                <option value="30">30 seconds</option>
                <option value="60">1 minute</option>
                <option value="300">5 minutes</option>
              </select>
            </div>
          </div>
        </div>
      </div>
      <!-- Edit Chart Modal -->
      <div id="editChartModal" class="modal">
        <div class="modal-content">
          <div class="modal-header">
            <h2>Edit Chart</h2>
            <button class="modal-close" id="closeEditModal">
              <i class="fas fa-times"></i>
            </button>
          </div>
          <div class="modal-body">
            <div class="setting-group">
              <div class="form-group">
                <label for="editChartName">Chart Name</label>
                <input type="text" id="editChartName" class="form-input" placeholder="Chart name (optional)...">
              </div>
              <div class="form-group">
                <label for="editChartQuery">Query</label>
                <input type="text" id="editChartQuery" class="form-input" placeholder="Enter your SnelDB query...">
              </div>
              <div class="form-group">
                <label for="editChartType">Chart Type</label>
                <select id="editChartType" class="form-select">
                  <option value="bar">Bar</option>
                  <option value="line">Line</option>
                  <option value="pie">Pie</option>
                  <option value="doughnut">Doughnut</option>
                </select>
              </div>
              <div class="modal-actions">
                <button id="saveChartBtn" class="btn btn-primary">Save</button>
                <button id="cancelEditBtn" class="btn btn-secondary">Cancel</button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </main>
  </div>
  <script src="/static/app.js"></script>
  <script src="/static/highlight.js"></script>
  <script src="/static/sneldb.js"></script>
  <script>
    (function(){
      var el = document.getElementById('hl');
      if (window.hljs && typeof hljs.highlightElement === 'function') {
        hljs.highlightElement(el);
      } else if (window.hljs && typeof hljs.highlightBlock === 'function') {
        hljs.highlightBlock(el);
      } else if (window.hljs && typeof hljs.initHighlightingOnLoad === 'function') {
        hljs.initHighlightingOnLoad();
      }
    })();
  </script>
  <script>window.SNELDB_AUTH_TOKEN = 'mysecrettoken';</script>
</body>
</html>


